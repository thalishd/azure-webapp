<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Gestionnaire de Prompts</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; display:flex; flex-direction:column; height:100vh; }
    header { background:#333; color:#fff; padding:1rem; text-align:center; }
    #prompt-list { flex:1; overflow-y:auto; padding:1rem; border-bottom:1px solid #ccc; }
    .prompt-item { padding:.75rem; margin-bottom:.5rem; border:1px solid #ccc; border-radius:5px; background:#fafafa; cursor:pointer; }
    .prompt-item:hover { background:#f0f0f0; }
    #editor { padding:1rem; display:flex; flex-direction:column; gap:.5rem; }
    #prompt-text { width:100%; height:100px; padding:.5rem; font-size:1rem; border:1px solid #ccc; border-radius:5px; resize:vertical; }
    #save-button { padding:.75rem; font-size:1rem; border:none; border-radius:5px; background-color:#4CAF50; color:#fff; cursor:pointer; }
    #save-button:disabled { background-color:#888; cursor:not-allowed; }
  </style>
</head>
<body>
  <header>Gestionnaire de Prompts</header>

  <div id="prompt-list"></div>

  <div id="editor">
    <textarea id="prompt-text" placeholder="Cliquez sur un prompt ou saisissez un nouveau prompt…"></textarea>
    <button id="save-button" disabled>Enregistrer</button>
  </div>

  <script>
    var base_url = "https://azure-api-h0hca4ckb8dwhrcj.swedencentral-01.azurewebsites.net";

    const promptListEl = document.getElementById('prompt-list');
    const promptTextEl = document.getElementById('prompt-text');
    const saveBtn      = document.getElementById('save-button');

    let prompts = [];
    let offset  = 0;
    let selected = null;

    function refreshList() {
      promptListEl.innerHTML = '';
      prompts.forEach((item, idx) => {
        const div = document.createElement('div');
        div.className = 'prompt-item';
        div.innerHTML = item.prompt.length > 50 ? item.prompt.slice(0,50) + '…' : item.prompt;
        div.index = idx;
        promptListEl.appendChild(div);
      });
    }

    async function getchats(id) {
      fetch(base_url + "/chats/" + id)
      .then((response) => {
        if (!response.ok) {
          return [];
        }
        return response.json();
      })
      .then((data) => {
        console.log(data);
      })
      .catch((error) => {
        console.error("Erreur lors de la récupération des chats :", error);
      });
    }

    // Chargement initial
    refreshList();
    getchats(0);
  </script>
</body>
</html>